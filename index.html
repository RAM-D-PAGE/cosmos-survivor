<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmos Survivor</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Supabase CDN -->
    <!-- Supabase CDN Removed (Using npm package) -->
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="game-container">
        <canvas id="game-canvas"></canvas>

        <!-- UI Overlay -->
        <!-- Top Right Auth Button -->
        <div id="auth-corner">
            <button id="login-btn" class="glow-btn" style="border-color:#ffff00; color:#ffff00">LOGIN</button>
            <button id="logout-btn" class="glow-btn hidden" style="border-color:#ff5555; color:#ff5555">LOGOUT</button>
        </div>

        <!-- Main Menu -->
        <div id="main-menu" class="glass-panel center-screen">
            <h1>COSMOS SURVIVOR</h1>
            <p data-locale="gameSubtitle">‡πÄ‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏£‡∏≠‡∏î‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤‡∏≠‡∏±‡∏ô‡πÑ‡∏£‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</p>
            <div class="menu-buttons">
                <button id="start-btn" class="glow-btn" data-locale="play">PLAY</button>
                <button id="start-multiplayer-btn" class="glow-btn hidden" style="border-color:#00ff88; color:#00ff88"
                    data-locale="multiplayer">MULTIPLAYER</button>
                <button id="open-leaderboard-btn" class="glow-btn" style="border-color:#ff00ea; color:#ff00ea"
                    data-locale="leaderboard">LEADERBOARD</button>
                <button id="open-settings-btn" class="glow-btn" style="border-color:#00ff88; color:#00ff88"
                    data-locale="settings">SETTINGS</button>
                <button id="open-help-btn" class="glow-btn" style="border-color:#00ccff; color:#00ccff"
                    data-locale="howToPlay">HELP</button>
                <!-- Hidden: Link TikTok -->
                <button id="link-tiktok-btn" class="glow-btn hidden" style="border-color:#00ffff; color:#00ffff">LINK
                    TIKTOK</button>
            </div>

        </div>


        <div id="leaderboard" class="hidden glass-panel center-screen">
            <h2 data-locale="leaderboard">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h2>
            <ul id="score-list"></ul>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button id="leaderboard-restart-btn" class="glow-btn"
                    style="display:none; flex:1;">‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
                <button id="close-leaderboard-btn" class="glow-btn" data-locale="close" style="flex:1;">‡∏õ‡∏¥‡∏î</button>
            </div>
        </div>

        <!-- HUD (Default Hidden) -->
        <div id="hud" class="hidden">
            <!-- Top Right: Game Timer -->
            <div id="game-timer">00:00</div>

            <!-- Top Center: Zone Info & Buffs -->
            <div id="zone-info-panel">
                <div id="current-zone-name">UNKNOWN SECTOR</div>
                <div id="active-buffs-container"></div>
            </div>

            <!-- Top Center: Zone Progress (Wave/Boss) -->
            <div id="zone-progress-container">
                <div id="zone-progress-label">ZONE PROGRESS</div>
                <div id="zone-progress-bar"></div>
            </div>

            <!-- Top Left: Player Status (HP/Energy) -->
            <div id="status-bars">
                <div id="hp-bar-container">
                    <div id="hp-bar-fill"></div>
                    <span id="hp-text">100 / 100</span>
                </div>
                <div id="energy-bar-container" style="margin-top:5px;">
                    <div id="energy-bar-fill"></div>
                    <!-- <span id="energy-text">100</span> -->
                </div>
                <div style="margin-top:5px; font-weight:bold; color:#ffd700; text-shadow:0 0 5px #000;">
                    üí∞ <span id="coin-display">0</span>
                </div>
                <button id="open-shop-btn" class="glow-btn" style="margin-top:10px; font-size:12px; padding:5px 10px;">
                    üõí SHOP
                </button>
            </div>

            <!-- Bottom Center: Inventory (Will be styled in CSS) -->
            <div id="inventory-panel">
                <div class="inv-slot" id="slot-0"></div>
                <div class="inv-slot" id="slot-1"></div>
                <div class="inv-slot" id="slot-2"></div>
                <div class="inv-slot" id="slot-3"></div>
                <div class="inv-slot" id="slot-4"></div>
            </div>

            <!-- Bottom: EXP Bar -->
            <div id="exp-bar-container">
                <div id="exp-bar-fill"></div>
                <span id="exp-text">LVL 1 - 0 / 100 XP</span>
            </div>
        </div>

        <!-- Stats Panel -->


        <!-- Upgrade Menu -->
        <div id="upgrade-menu" class="glass-panel hidden">
            <h2>System Upgrade Available</h2>
            <div id="card-container">
                <!-- Cards injected by JS -->
            </div>
        </div>

        <!-- Pause Button (shows during gameplay only) -->
        <div id="pause-btn-container" class="hidden">
            <button id="pause-btn">‚ùö‚ùö</button>
        </div>

        <!-- Skills/Pause Menu (Tab) -->
        <div id="skills-menu" class="glass-panel center-screen hidden">
            <h2 data-locale="paused">‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß</h2>
            <div class="skills-content">
                <div class="column">
                    <h3 id="ship-status-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏¢‡∏≤‡∏ô</h3>
                    <ul id="skills-list">
                        <!-- List injected by JS -->
                    </ul>
                </div>
            </div>
            <button id="resume-btn" class="glow-btn" data-locale="resume" style="margin-top: 20px;">‡πÄ‡∏•‡πà‡∏ô‡∏ï‡πà‡∏≠</button>
            <button id="pause-settings-btn" class="glow-btn" data-locale="settings"
                style="margin-top: 10px; border-color:#00ff88; color:#00ff88">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
        </div>

        <!-- Skill Management Panel -->
        <!-- Skill Management Panel moved to lines 287 -->

        <!-- Shop Panel -->
        <div id="shop-panel" class="glass-panel center-screen hidden">
            <h2>üõí SHOP</h2>
            <div style="margin-bottom:20px; font-size:18px; color:#ffd700;">
                üí∞ Coins: <span id="shop-coin-display">0</span>
            </div>
            <div id="shop-items-container"
                style="display:grid; grid-template-columns:repeat(auto-fill, minmax(200px, 1fr)); gap:15px; width:100%; overflow-y:auto; padding:10px;">
                <!-- Shop items will be injected here -->
            </div>
            <button id="close-shop-btn" class="glow-btn" data-locale="close">CLOSE</button>
        </div>

        <!-- Help Panel -->
        <div id="help-panel" class="glass-panel center-screen hidden">
            <h2 data-locale="howToPlay">HOW TO PLAY</h2>
            <div class="control-list">
                <div class="control-item">
                    <span class="key-icon">WASD</span>
                    <span class="control-desc" data-locale="cMove">WASD Move</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">MOUSE</span>
                    <span class="control-desc" data-locale="cAim">Aim / Shoot</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">SPACE</span>
                    <span class="control-desc" data-locale="cDash">Dash</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">1 / 2 / 3</span>
                    <span class="control-desc" data-locale="cSkill">Use Skills</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">TAB</span>
                    <span class="control-desc" data-locale="cPause">Pause</span>
                </div>
            </div>
            <button id="close-help-btn" class="glow-btn" style="margin-top: 20px;" data-locale="close">CLOSE</button>
        </div>

        <!-- Settings Panel -->
        <div id="settings-panel" class="glass-panel center-screen hidden">
            <h2 data-locale="settings">SETTINGS</h2>

            <div class="settings-section">
                <label data-locale="language">Language</label>
                <div class="settings-row">
                    <button id="lang-en-btn" class="setting-btn active">Eng</button>
                    <button id="lang-th-btn" class="setting-btn">Thai</button>
                </div>
            </div>

            <div class="settings-section">
                <label data-locale="masterVolume">Master Volume</label>
                <div class="settings-row">
                    <input type="range" id="master-volume" min="0" max="100" value="70" class="slider">
                    <span id="master-volume-val">70%</span>
                </div>
            </div>

            <div class="settings-section">
                <label data-locale="sfxVolume">SFX Volume</label>
                <div class="settings-row">
                    <input type="range" id="sfx-volume" min="0" max="100" value="80" class="slider">
                    <span id="sfx-volume-val">80%</span>
                </div>
            </div>

            <div class="settings-section">
                <label data-locale="screenShake">Screen Shake</label>
                <div class="settings-row">
                    <button id="shake-toggle-btn" class="setting-btn active">ON</button>
                </div>
            </div>

            <div class="settings-section">
                <label data-locale="damageNumbers">Damage Numbers</label>
                <div class="settings-row">
                    <button id="dmg-numbers-toggle-btn" class="setting-btn active">ON</button>
                </div>
            </div>

            <div class="settings-section">
                <label data-locale="showFps">Show FPS</label>
                <div class="settings-row">
                    <button id="fps-toggle-btn" class="setting-btn">OFF</button>
                </div>
            </div>

            <div class="settings-section">
                <label data-locale="resumeDelay">Resume Delay</label>
                <div class="settings-row">
                    <button id="delay-toggle-btn" class="setting-btn active">ON</button>
                </div>
            </div>

            <button id="close-settings-btn" class="glow-btn" style="margin-top: 20px;"
                data-locale="close">CLOSE</button>
        </div>


        <!-- Tooltip -->
        <div id="tooltip" class="hidden"></div>

        <!-- Dash Cooldown Indicator -->
        <div id="dash-indicator" class="hidden">
            <div id="dash-charges"></div>
            <span id="dash-text">DASH</span>
        </div>

        <!-- Skill Bar (Bottom Right) - Hidden by default -->
        <div id="skills-bar" class="hidden">
            <div id="skill-0" class="skill-slot"></div>
            <div id="skill-1" class="skill-slot"></div>
            <div id="skill-2" class="skill-slot"></div>
        </div>
        <button id="manage-skills-btn" class="hidden">‚öô SKILLS</button>

        <!-- Difficulty Selection (Main Menu) -->
        <div id="difficulty-select" class="hidden">
            <button class="diff-btn" data-diff="EASY">EASY</button>
            <button class="diff-btn" data-diff="NORMAL">NORMAL</button>
            <button class="diff-btn" data-diff="HARD">HARD</button>
            <button class="diff-btn" data-diff="ABYSS">ABYSS</button>
            <button class="diff-btn" data-diff="HELL">HELL</button>
            <button class="diff-btn" data-diff="IMPOSSIBLE">IMPOSSIBLE</button>
        </div>

        <!-- Skill Management Panel -->
        <div id="skill-manage-panel" class="hidden glass-panel center-screen">
            <h2 data-locale="skillManagement">SKILL MANAGEMENT</h2>
            <div class="skill-slots-container">
                <!-- Active Skills -->
                <h3>Active Skills (Grid 3x3)</h3>
                <div id="active-skills-row">
                    <div class="slot-manage" data-slot="0" draggable="true">
                        <div id="slot-0-skill">Empty</div>
                        <div class="slot-label">KEY 1</div>
                    </div>
                    <div class="slot-manage" data-slot="1" draggable="true">
                        <div id="slot-1-skill">Empty</div>
                        <div class="slot-label">KEY 2</div>
                    </div>
                    <div class="slot-manage" data-slot="2" draggable="true">
                        <div id="slot-2-skill">Empty</div>
                        <div class="slot-label">KEY 3</div>
                    </div>
                </div>

                <!-- Bag Skills -->
                <h3>Skill Bag (Drag to Swap)</h3>
                <div id="skill-bag-grid">
                    <!-- Bag slots will be generated here -->
                </div>
            </div>
            <div style="margin-top:20px; font-size:14px; color:#aaa;">
                Click two slots to swap skills
            </div>
            <button id="close-skill-manage-btn" class="glow-btn" style="margin-top:20px;"
                data-locale="close">CLOSE</button>
        </div>



        <!-- Game Over Screen -->
        <div id="game-over-screen" class="glass-panel center-screen hidden">
            <h2>‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏´‡∏≤‡∏¢</h2>
            <p>‡∏ï‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡∏´‡∏ô‡∏±‡∏Å</p>
            <div id="final-score" style="margin: 20px; font-size: 24px; color: #00fff2;"></div>
            <input type="text" id="player-name-input" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠" maxlength="10"
                style="padding: 10px; font-size: 18px; text-transform: uppercase;">
            <button id="submit-score-btn" class="glow-btn" style="margin-top: 10px;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
            <button id="restart-btn" class="glow-btn">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
            <button id="quit-btn" class="glow-btn"
                style="margin-top: 10px; border-color: #ff0055; color: #ff0055;">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏°</button>
        </div>
        <!-- Login Modal -->
        <div id="login-modal" class="glass-panel center-screen hidden">
            <h2>PILOT AUTHENTICATION</h2>
            <div style="display:flex; flex-direction:column; gap:10px; margin:20px 0;">
                <input type="email" id="login-username-input" placeholder="EMAIL" maxlength="50"
                    style="padding: 10px; font-size: 18px;">
                <input type="password" id="login-password-input" placeholder="PASSWORD" maxlength="20"
                    style="padding: 10px; font-size: 18px;">
            </div>
            <div id="login-msg" style="color:red; margin-bottom:10px; height:20px;"></div>
            <div style="display: flex; gap: 10px;">
                <button id="confirm-login-btn" class="glow-btn"
                    style="border-color:#00ff00; color:#00ff00; flex:1;">LOGIN</button>
                <button id="register-btn" class="glow-btn"
                    style="border-color:#00ccff; color:#00ccff; flex:1;">REGISTER</button>
            </div>
            <!-- Google Login -->
            <button id="google-login-btn" class="glow-btn"
                style="margin-top: 10px; border-color:#ffffff; color:#ffffff;">
                LOG IN WITH GOOGLE
            </button>
            <button id="cancel-login-btn" class="glow-btn" style="margin-top: 10px;">CANCEL</button>
        </div>

        <!-- User Display (Top Left of Menu) -->
        <div id="user-display" class="hidden"
            style="position:absolute; top:20px; right:20px; font-size:20px; color:#00ff00; text-shadow:0 0 10px #00ff00; font-weight:bold;">
        </div>

        <!-- MultiPlayer Menu -->
        <div id="multiplayer-menu" class="glass-panel center-screen hidden">
            <h2>üåê MULTIPLAYER</h2>
            <div style="display:flex; flex-direction:column; gap:15px; margin:20px 0;">
                <button id="create-room-btn" class="glow-btn" style="border-color:#00ff88; color:#00ff88;">
                    CREATE ROOM
                </button>
                <div style="display:flex; gap:10px; align-items:center;">
                    <input type="text" id="join-room-input" placeholder="Room ID" maxlength="10"
                        style="flex:1; padding:12px; font-size:16px; background:rgba(0,0,0,0.6); border:2px solid var(--primary-color); border-radius:8px; color:white; text-align:center; text-transform:uppercase;">
                    <button id="join-room-btn" class="glow-btn"
                        style="border-color:#00ccff; color:#00ccff; padding:12px 24px;">
                        JOIN
                    </button>
                </div>
            </div>
            <div id="multiplayer-status"
                style="margin-top:20px; padding:15px; background:rgba(0,0,0,0.4); border-radius:8px; font-size:14px; color:#aaa;">
                Not connected
            </div>
            <div id="connected-players-list"
                style="margin-top:15px; text-align:left; max-height:200px; overflow-y:auto;">
                <!-- Players will be listed here -->
            </div>
            <button id="close-multiplayer-btn" class="glow-btn" style="margin-top:20px;">CLOSE</button>
        </div>

    </div>
    </div>

    <!-- Main Module -->
    <script type="module" src="src/main.ts"></script>
</body>

</html>